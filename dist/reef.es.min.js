/*! reef v12.3.2 | (c) 2023 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
function e(e,t,n=document){let r=new CustomEvent(`reef:${e}`,{bubbles:!0,cancelable:!0,detail:t});return n.dispatchEvent(r)}function t(e){return"string"==typeof e?document.querySelector(e):e}function n(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function r(t,o){let i="store"+(t?`-${t}`:"");return{get:(e,i)=>"_isProxy"===i||(["object","array"].includes(n(e[i]))&&!e[i]._isProxy&&(e[i]=new Proxy(e[i],r(t,o))),e[i]),set:(t,n,r)=>(t[n]===r||(t[n]=r,e(i,o)),!0),deleteProperty:(t,n)=>(delete t[n],e(i,o),!0)}}function o(e={},t=""){return e=["array","object"].includes(n(e))?e:{value:e},new Proxy(e,r(t,e))}class i{constructor(t,n,r=""){let o="store"+(r?`-${r}`:"");Object.defineProperties(this,{data:{get:()=>structuredClone(t),set:()=>!0}});for(let r in n)"function"==typeof n[r]&&(this[r]=function(...i){n[r](t,...i),e(o,t)})}}function s(e={},t={},n=""){return new i(e,t,n)}let l=["input","option","textarea"],c=["value","checked","selected"],u=["checked","selected"];function d(e){return["false","null","undefined","0","-0","NaN","0n","-0n"].includes(e)}function a(e,t,n,r){if(!t.startsWith("on")||!r)return;if(e[t])return;let o=r[n.split("(")[0]];o&&(e[t]=o)}function f(e,t){let n=t.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!n.includes("javascript:")&&!n.includes("data:text/html"))||(!!(e.startsWith("on")||e.startsWith("@on")||e.startsWith("#on"))||void 0)}function h(e,t,n,r){a(e,t,n,r),f(t,n)||(c.includes(t)&&(e[t]="value"===t?n:" "),e.setAttribute(t,n))}function m(e,t){c.includes(t)&&(e[t]=""),e.removeAttribute(t)}function p(e,t){if(1===e.nodeType){for(let{name:n,value:r}of e.attributes){if(f(n,r)){m(e,n),a(e,n,r,t);continue}if(!n.startsWith("@")&&!n.startsWith("#"))continue;let o=n.slice(1);m(e,n),u.includes(o)&&d(r)||h(e,o,r,t)}if(e.childNodes)for(let n of e.childNodes)p(n,t)}}function y(e){return e.childNodes&&e.childNodes.length?null:e.textContent}function b(e,t){return"number"==typeof e.nodeType&&e.nodeType!==t.nodeType||"string"==typeof e.tagName&&e.tagName!==t.tagName||"string"==typeof e.id&&e.id!==t.id||"string"==typeof e.src&&e.src!==t.src}function g(e,t,n){let r=e.childNodes,o=t.childNodes;(function(e){let t=e.querySelectorAll("script");for(let e of t)e.remove()})(e)||(r.forEach((function(e,r){if(!o[r]){let r=e.cloneNode(!0);return p(r,n),void t.append(r)}if(b(e,o[r])){let t=function(e,t,n){return Array.from(t).slice(n+1).find((function(t){return!b(e,t)}))}(e,o,r);if(!t){let t=e.cloneNode(!0);return p(t,n),void o[r].before(t)}o[r].before(t)}if(function(e,t,n){if(1!==e.nodeType)return;let r=e.attributes,o=t.attributes;for(let{name:o,value:i}of r){if(o.startsWith("#"))continue;if(c.includes(o)&&l.includes(e.tagName.toLowerCase()))continue;let r=o.startsWith("@")?o.slice(1):o;u.includes(r)&&d(i)?m(t,r):h(t,r,i,n)}for(let{name:e,value:n}of o)r[e]||c.includes(e)&&l.includes(t.tagName.toLowerCase())||m(t,e)}(e,o[r],n),e.nodeName.includes("-"))return;let i=y(e);if(i&&i!==y(o[r])&&(o[r].textContent=i),e.childNodes.length||!o[r].childNodes.length){if(!o[r].childNodes.length&&e.childNodes.length){let t=document.createDocumentFragment();return g(e,t,n),void o[r].appendChild(t)}e.childNodes.length&&g(e,o[r],n)}else o[r].innerHTML=""})),function(e,t){let n=e.length-t.length;if(!(n<1))for(;n>0;n--)e[e.length-1].remove()}(o,r))}function v(n,r,o){let i=t(n),s=function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head&&t.head.childNodes.length&&Array.from(t.head.childNodes).reverse().forEach((function(e){t.body.insertBefore(e,t.body.firstChild)})),t.body||document.createElement("body")}(r);e("before-render",null,i)&&(g(s,i,o),e("render",null,i))}class N{constructor(e,t,n){var r;this.elem=e,this.template=t,this.stores=n.stores?n.stores.map((e=>`reef:store-${e}`)):["reef:store"],this.events=n.events,this.handler=(r=this,function(e){r.render()}),this.debounce=null,this.start()}start(){for(let e of this.stores)document.addEventListener(e,this.handler);this.render(),e("start",null,t(this.elem))}stop(){for(let e of this.stores)document.removeEventListener(e,this.handler);e("stop",null,t(this.elem))}render(){let e=this;e.debounce&&window.cancelAnimationFrame(e.debounce),e.debounce=window.requestAnimationFrame((function(){v(e.elem,e.template(),e.events)}))}}function w(e,t,n={}){return new N(e,t,n)}function x(e){return e}export{w as component,x as listeners,v as render,s as setter,o as store};
//# sourceMappingURL=reef.es.min.js.map
